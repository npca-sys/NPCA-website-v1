<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="imagetoolbar" content="no">
<meta name="author" content="bombee">
<meta name="description" content="灘校パソコン部のウェブサイトです。">
<meta name="keywords" content="npca,パソコン,コンピュータ,クラブ,nada,灘,灘校,中学,高校,web,プログラム,プログラミング,program,部活,trlocon,電脳,電脳科学研究部,部誌">
<meta name="name" content="npca">
<meta name="ROBOTS" content="INDEX,FOLLOW">
<meta name="title" content="npca's WebPage">
<meta name="WWWC" content="2009/11/27 ( サイトリニューアル決定！ )">
<link rev="made" href="mailto:naclubkaityo@gmail.com">
<link rel="index" href="index.html">
<link rel="StyleSheet" type="text/css" media="all" href="npca/css/bulletin.css" charset="UTF-8">
<style type="text/css">
<!--
	@media screen, tv {
		h1 {
			background-image : url('npca/image/title/bulletin.png');
		}
	}
//-->
</style>
<style type="text/css">
<!--
table#CODECS {
	width : 25em ;
	text-align : center ;
}
	#CODECS th {
		border-bottom : 1px solid #000 ;
	}
	#CODECS th.codec, #CODECS td.codec {
		border-right : 1px solid #000 ;
	}
table#fps24, table#fps30 {
	width : 600px ;
}
	td.fps {
		width : 200px ;
	}
//-->
</style>
<title>npca - 部誌公開</title>
</head>
<body>
<h1><img alt="部誌公開" src="npca/image/index_p/bulletin.png" height="40" width="300"></h1>
<hr>
<pre>
現在位置：　<a href="index.html">ホーム</a> -&gt; <a href="index.html%3Fbulletin.html">部誌公開</a> - 「録画番組パソコンで！AVI版。」計画再浮上！
</pre>
<!-- 個別内容ここから -->

<h2>「録画番組パソコンで！AVI版。」計画再浮上！</h2>
<p class="attention">外部へのリンクを別ウィンドウで開きたい時は、Shiftキーを押しながらクリックしてください。</p>
<h3>第四章 ノイズ除去に関するちょっと良い話</h3>
<p>最後は、ノイズ除去に関するお話。ノイズとは三省堂提供「大辞林 第二版」によると</p>
<p class="quote">「情報理論などで、信号の性質・内容に影響を与えるおそれのあるデータの乱れ。」</p>
<p class="noindent">だそうです。そのまんまですね。この章ではそのノイズを変換時にフィルタで取る方法を載せていきます。とはいえノイズにも色々と種類があって、その種類ごとに対処法も変わってきます。それぞれのノイズに対応したAviUtlのフィルタの置いてあるアドレスも載せておくので困ったら参照してみてください。</p>
<h4>1:エンコーダによって生じるノイズ</h4>
<ul>
<li>ブロックノイズ</li>
<li>モスキートノイズ</li>
<li>残像</li>
</ul>
<p>エンコーダで動画を変換すると、映像のサイズは1/10近く小さくなります。ってことはその圧縮の過程で確実にいくつかの情報が抜け落ちています。そうして発生するのが「ブロックノイズ」「モスキートノイズ」です。まず、この2つのノイズの説明です。</p>
<p class="quote"><em>「ブロックノイズ」</em>はモザイク上の小さな四角が発生するノイズ。画面で暗い部分で、色が平坦に広がっている場所に発生することが多いです。これはエンコーダは普通小さなブロックに区分して、ブロック単位で変換しているために生じています。そうやってブロックで変換する際、そのブロックを変換するときに一番適した符号が圧縮に使われます。この時、隣のブロックと色がほとんど同じ場合、微妙な違いで符号が変わり、結果としてほとんど同じ色だったはずの隣のブロックと差が生じます。また、ブロックごとに変換する際、高い周波数成分を減らすんですが、それが暗い部分で起こりやすい原因だったりします。h264ではこのブロックのサイズを面積にして1/4にしているので、x264はブロックノイズが発生しにくいです。ただブロックのサイズを小さくするということは変換時の計算量を増やすことにも繋がるのでx264は他のエンコーダよりも重くて時間がかかる原因になってます。WMVがなんであんなに重いかは不明。本当になんでだろ・・・。</p>
<p class="quote"><em>「モスキートノイズ」</em>は蚊の大群がまとわりついたように見えることから名づけられたノイズ。
アニメなどの塗りつぶしたような単色の部分がある場面で、それと隣接する色調の大きく違う色がある場合、
例えば人の輪郭周りなどで多く発生します。発生理由はブロックノイズと似ていて、
変換時に高い周波数成分が失われるためで、こちらはブロック内部で起こるために
蚊の大群がまとわりついたように見えてしまいます。</p>
<p>どちらも映像を変換する際にビットレートが低すぎる場合に起こりやすいです。ちなみにx264で変換された映像はこのどちらもが低く抑えられるようになっています。h264系のエンコーダって、重くなければ本当に良いエンコーダなんだけどなぁ・・・。</p>

<h4>2:録画時に入ってしまったノイズ</h4>
<h5>(1)通常ノイズ</h5>
<ul>
<li>2Dノイズ</li>
<li>3Dノイズ</li>
<li>縦線ゴースト</li>
</ul>
<p>どれだけすごいDVDレコーダーを使っても、地上波放送ならテレビの放送局から自分の家まで電波が来る過程で必ず電波自体が劣化します。それがこれらのノイズの元となっています。「うちの家はデジタル放送だからそんな心配ないよ〜」とのたまう、ぶるじょわじーなあなたは無視してください。</p>
<p class="quote"><em>「2Dノイズ・3Dノイズ」</em>は映像全体に入るザラザラしたノイズの事。最初に2Dノイズ、3Dノイズと別々に扱いましたけど、実質同じです。この2つの違いはフィルタを使ってノイズを取る際の方法に関わってきます。「2D」「3D」とはそれぞれ「2-Dimension」と「3-Dimension」、つまり二次元と三次元の事なんですがもちろん映像に奥行きはないので三次元の方は通常の意味での三次元ではありません。三つ目の座標軸をZ軸ではなく時間方向の軸、つまり時間軸として考えた場合の呼び名です。つまり2Dのノイズ除去フィルタとはある画素とその周りの画素を調べて、その差が著しかった場合に違いを少なくしてノイズを除去する方法で、3Dのノイズ除去フィルタはある画素と同じ場所の前のフレーム、次のフレームの画素を調べて時間軸的な差が少なくなるようにしてノイズを除去する方法です。AviUtlには標準的にどちらもついていて、3Dノイズ除去フィルタはそれでいいんですが2Dノイズ除去フィルタはそれだけでなく、「<a href="http://homepage2.nifty.com/GNB/">GNBの館</a>」さんの「Wavelet_NR_Type-G」を併用することを薦めます。ウェーブレットという技術を使ったフィルタで、輪郭を残したままのノイズ除去が可能です。数値の設定項目が滅茶苦茶多いんですけど、その補助をしてくれる「TypeG_Helper」もあります。このフィルタはとても強力な上に正確ですが、エッジ部分のノイズは取りきれません。そこでAviUtlに標準でついてくるフィルタでこれを取ります。ちなみにこのウェーブレットの技術を使った3Dノイズ除去フィルタも存在していて、精度も標準についてくるフィルタより高いんですが異常に重く、変換にかかる時間が2倍以上になってしまうのでオススメしません。スペックの高いパソコンなら試す価値はあると思いますが。ちなみに3Dのノイズ除去フィルタは2Dのノイズ除去フィルタより前に持ってきたほうがいい感じ。違いはほとんど無いですけど、なんとなくそんな気がするので。</p>
<p class="quote"><em>「縦線ゴースト」</em>とは映像全体に縦にかかる輝度の違う線の事で、これはAviUtlに標準で入っているフィルタでほとんど消すことが出来ます。縦線ゴーストの入る原因を調べてみたんですが、情報が少なく見つかりませんでした・・・。後、標準で入ってるフィルタの使い方がわかりにくいので、っていうか僕はわからなかったので書いとくと、どこか真っ白、もしくは全体が灰色の場所で「ゴーストの検索」ボタンを押してください。それだけで映像全てに縦線ゴースト除去がかかります。</p>
<p>通常ノイズ、というか通常のノイズ除去フィルタで取るノイズは大抵これだけです。後、つい忘れがちなことですが、フィルタは「もうちょっと取った方がいいかな？」ぐらいノイズをのこしておいて変換しておいたほうが綺麗に変換できます。あまりにノイズをとりすぎると色と色の境が無くなったり、残像が出たりします。値を調節するときに見るプレビュー画面は止まっている映像なので動かして見たときと随分と印象が違い、ノイズがとても多く見えます。なのでノイズはかなり残ってるなぁ、と思う程度で充分です。注意してください。</p>
<h5>(2)特殊ノイズ</h5>
<ul>
<li>画面端のギザギザノイズ</li>
<li>ゴースト</li>
<li>透過性ロゴ</li>
</ul>
<p>これらはノイズ除去フィルタで取る物ではなかったり、特殊な場合に入るノイズのようでノイズでないものの取るものです。よくよく考えたら「ノイズ」の話に書くのもおかしいんですが、ついでなんで一緒に書いちゃいます。</p>
<p class="quote"><em>「画面端のギザギザノイズ」</em>はどこで検索しても引っかかりません。当たり前です。僕の造語です（オイ）。というのもこれは滅多に入らないノイズというか、僕以外に見たこと無いので・・・。画面端がのこぎりの歯みたいに1ドットずつ交互に違う色が入ってしまう現象で、これを前述のフィルタで取ろうとするとかなり強力に除去をかけなければならなく、他の普通の映像にも影響を及ぼしてしまいます。で、どうすればいいかと言うと・・・。無理です。とれません。画面端のノイズであることを利用してクリッピングで削っちゃいます。いや、無理な物は無理なんですって。しょうがないんですって。人間、限界はありますって。</p>
<p class="quote"><em>「ゴースト」</em>はどちらかというと(1)に入ってもいいようなノイズで、真っ白な画面に黒い部分、つまり真っ白い紙に真っ黒い文字が書かれているような場面でその周りにゴーストのように同じ文字がずれて薄く表示されてしまうことです。一応AviUtlにも標準でゴースト除去フィルタはあるんですが、全くと言っていいほど取れません。僕自身有効な対策を未だ見つけられていません。これもあきらめましょう。</p>
<p class="quote"><em>「透過性ロゴ」</em>はBS放送などで入る右上の文字の事で、これはある程度取ることができます。というのも原理自体は簡単で、これらのロゴはロゴ自体の色と本来の色を重ね合わせて表示させているため、ロゴ自体の色を引けば元の色が現れます。MakKiさんの「透過性ロゴ フィルタ」が有効で、重宝しています。僕はBS-2でしか使ったことはありませんが、他にもANIMAXやスカパー！等にも対応しているそうです。録画したにはいいけど、右上に入るロゴが邪魔で邪魔でしょうがない人は試してみてはいかがでしょうか。</p>
<p>ここまでツラツラと長く書いてきたんですが、基本的な対策がわかってきたところで復習もかねて実際に僕が使っているフィルタとその順序を載せておきます。うちの環境にはこれがぴったりなんですが、録画環境によっては臨機応変に変化させる必要があります。学問に王道なし、変換道にノーベルあり、です。この記事を参考にがんばって練習しましょう！</p>
<ol>
<li>「ゴースト(縦線)除去」(AviUtl標準)</li>
<li>「クリッピング」(AviUtl標準)</li>
<li>「YC伸張フィルタ(<a href="index.html%3Fbulletin=2006014.html#B01">*1</a>)」(<a href="http://c-zone-web4654.hp.infoseek.co.jp/alcv/">aLCv for MovieEdit</a>)</li>
<li>「ノイズ除去(時間軸)フィルタ」(AviUtl標準)</li>
<li>「Wavelet\_NR Type-G」(<a href="http://homepage2.nifty.com/GNB/">GNBの館</a>)</li>
<li>「ノイズ除去フィルタ」(AviUtl標準)</li>
<li>「Lanczos 3-lobed 拡大縮小」(<a href="http://www.marumo.ne.jp/">まるも製作所</a>)</li>
<li>「透過性ロゴ」(<a href="http://mksoft.hp.infoseek.co.jp/">MakKi's SoftWare</a>)</li>
</ol>
<p class="note"><a class="name" name="B01">*1</a>: 16〜235の色範囲を0〜255に伸張したりする場合や4:1:1を4:4:4に補完してくれるフィルタ。簡単に言えば明るすぎたり暗すぎたり赤が薄すぎる場合に使います。実際に試してもらった方がわかりやすいのでやってみてください。</p>
<h3 class="hr_over">目次</h3>
<ul>
<li><a href="index.html%3Fbulletin=2006011.html">前書き</a></li>
<li><a href="index.html%3Fbulletin=2006012.html">エンコーダに関するちょっと良い話</a></li>
<li><a href="index.html%3Fbulletin=2006013.html">フレームレートに関するちょっと良い話</a></li>
<li>ノイズ除去に関するちょっと良い話</li>
<li><a href="index.html%3Fbulletin=2006015.html">最後に</a></li>
</ul>

<p id="author">59回生 ノーベル</p>

<!-- 個別内容ここまで -->
<hr>
<pre>
現在位置：　<a href="index.html">ホーム</a> -&gt;  <a href="index.html%3Fupdate.html">更新履歴</a> - サイトの歩みなど
　　　　　　　　　     <a href="index.html%3Fnpca.html">活動理念</a> - 趣旨、目標、近況などなど
　　　　　　　　　     <a href="index.html%3Fprogram.html">部員作品</a> - 部員が製作した作品の展示
　　　　　　　　　     <a href="index.html%3Ftech.html">技術解説</a> - 使用した技術の紹介
　　　　　　　　　    [<a href="index.html%3Fbulletin.html">部誌公開</a>]
　　　　　　　　　     <a href="index.html%3Fdiary.html">内部事情</a> - 主に管理者の日記
　　　　　　　　　     <a href="index.html%3Fbbs.html">御意見板</a> - ご意見、ご感想などはこちらへ(現在開設予定なし)
　　　　　　　　　     <a href="index.html%3Fmail.html">恋文投函</a> - 部にメールを送信
　　　　　　　　　     <a href="index.html%3Flinks.html">社会之窓</a> - 他サイト様へのリンク集
　　　　　　　　　     <a href="index.html%3Fmembers.html">部員専用</a> - 部員専用のスペースです
</pre>
<address>&copy; Copyright 2006 <a href="http://trlocon.ddo.jp/~npca/">npca</a> &amp; <a href="http://faey.flnet.org/">FeyFay Laboratory</a>. All rights reserved.</address>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-4970457-1";
urchinTracker();
// -->
</script>
</body>
</html>
